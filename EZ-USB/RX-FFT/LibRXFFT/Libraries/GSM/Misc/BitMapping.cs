namespace LibRXFFT.Libraries.GSM.Misc
{
    public class BitMapping
    {
        public static void Unmap(bool[] srcBuffer, int srcStart, bool[] dstBuffer, int dstStart, uint[] table)
        {
            Unmap(srcBuffer, srcStart, dstBuffer, dstStart, table.Length, table);
        }

        public static void Unmap(bool[] srcBuffer, int srcStart, bool[] dstBuffer, int dstStart, int length, uint[] table)
        {
            for (int pos = 0; pos < length; pos++)
                dstBuffer[dstStart + table[pos]] = srcBuffer[srcStart + pos];
        }

        public static void Map(bool[] srcBuffer, int srcStart, bool[] dstBuffer, int dstStart, uint[] table)
        {
            Map(srcBuffer, srcStart, dstBuffer, dstStart, table.Length, table);
        }

        public static void Map(bool[] srcBuffer, int srcStart, bool[] dstBuffer, int dstStart, int length, uint[] table)
        {
            for (int pos = 0; pos < length; pos++)
                dstBuffer[dstStart + pos] = srcBuffer[srcStart + table[pos]];
        }

        /*
         * GSM-05.03 v9.0
         * 
         * Table 6: Ordering of enhanced full rate speech parameters for the channel encoder 
         * (subjective importance of encoded bits, after preliminary channel coding)
         * 
         * mapping w[0..259] -> d[0..259]
         * index in this array is d[] position, value is w[] position
         */
        public static uint[] EFRBitOrder = new uint[]
        {
			8, 39, 40, 41, 42, 43, 145, 146, 147, 148, 149, 150, 93, 94, 200, 201, 
			47, 88, 99, 140, 44, 151, 95, 202, 1, 2, 7, 9, 17, 18, 23, 45, 46, 152, 
			153, 96, 203, 3, 4, 10, 11, 15, 8, 5, 6, 12, 16, 19, 97, 204, 0, 13, 14, 
			20, 24, 25, 27, 154, 206, 195, 247, 89, 141, 196, 248, 252, 253, 254, 
			255, 256, 257, 258, 259, 48, 100, 155, 207, 21, 22, 26, 28, 51, 55, 59, 
			63, 67, 103, 107, 111, 115, 119, 158, 162, 166, 170, 174, 210, 214, 218, 
			222, 226, 90, 142, 197, 249, 49, 101, 156, 208, 29, 30, 31, 32, 33, 34, 
			35, 98, 205, 52, 56, 60, 64, 68, 104, 108, 112, 116, 120, 159, 163, 167, 
			171, 175, 211, 215, 219, 223, 227, 53, 57, 61, 65, 105, 109, 113, 117, 
			160, 164, 168, 172, 212, 220, 224, 91, 143, 198, 250, 50, 102, 157, 209, 
			92, 144, 199, 251, 54, 58, 62, 66, 106, 110, 114, 118, 161, 165, 169, 
			173, 213, 221, 225, 36, 37, 69, 71, 72, 121, 123, 124, 176, 178, 179, 
			228, 230, 231, 216, 217, 70, 122, 177, 229, 73, 76, 79, 82, 85, 125, 
			128, 131, 134, 137, 180, 183, 186, 189, 192, 232, 235, 238, 241, 244, 
			74, 77, 80, 83, 86, 126, 129, 132, 135, 138, 181, 184, 187, 190, 193, 
			233, 236, 239, 242, 245, 75, 78, 81, 84, 87, 127, 130, 133, 136, 139, 
			182, 185, 188, 191, 194, 234, 237, 240, 243, 246
        };

        /*
         * GSM-05.03 Table 7
         * 
         * AMR 12.2 kbit/s - subjective importance bit ordering
         * 
         * checked against:
         * http://bb.osmocom.org/trac/browser/src/shared/libosmocore/src/codec/gsm690.c 
         */
        public static uint[] AMR12BitOrder = new uint[]
        {
			0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 23, 15, 16, 17, 18, 
			19, 20, 21, 22, 24, 25, 26, 27, 28, 38, 141, 39, 142, 40, 143, 41, 144, 
			42, 145, 43, 146, 44, 147, 45, 148, 46, 149, 47, 97, 150, 200, 48, 98, 
			151, 201, 49, 99, 152, 202, 86, 136, 189, 239, 87, 137, 190, 240, 88, 
			138, 191, 241, 91, 194, 92, 195, 93, 196, 94, 197, 95, 198, 29, 30, 31, 
			32, 33, 34, 35, 50, 100, 153, 203, 89, 139, 192, 242, 51, 101, 154, 204, 
			55, 105, 158, 208, 90, 140, 193, 243, 59, 109, 162, 212, 63, 113, 166, 
			216, 67, 117, 170, 220, 36, 37, 54, 53, 52, 58, 57, 56, 62, 61, 60, 66, 
			65, 64, 70, 69, 68, 104, 103, 102, 108, 107, 106, 112, 111, 110, 116, 
			115, 114, 120, 119, 118, 157, 156, 155, 161, 160, 159, 165, 164, 163, 
			169, 168, 167, 173, 172, 171, 207, 206, 205, 211, 210, 209, 215, 214, 
			213, 219, 218, 217, 223, 222, 221, 73, 72, 71, 76, 75, 74, 79, 78, 77, 
			82, 81, 80, 85, 84, 83, 123, 122, 121, 126, 125, 124, 129, 128, 127, 
			132, 131, 130, 135, 134, 133, 176, 175, 174, 179, 178, 177, 182, 181, 
			180, 185, 184, 183, 188, 187, 186, 226, 225, 224, 229, 228, 227, 232, 
			231, 230, 235, 234, 233, 238, 237, 236, 96, 199
        };


        /*
         * GSM-05.03 Table 2 / GSM-06.10 Table A.2.1a
         * 
         * GSM Full Rate - subjective importance bit ordering
         * 
         * checked against:
         * http://bb.osmocom.org/trac/browser/src/shared/libosmocore/src/codec/gsm610.c 
         */
        public static uint[] g610BitOrder = new uint[]
        {
			0, 47, 103, 159, 215, 1, 6, 12, 2, 7, 13, 17, 36, 92, 148, 
			204, 48, 104, 160, 216, 8, 22, 26, 37, 93, 149, 205, 38, 94, 
			150, 206, 39, 95, 151, 207, 40, 96, 152, 208, 49, 105, 161, 
			217, 3, 18, 30, 41, 97, 153, 209, 23, 27, 43, 99, 155, 211, 
			42, 98, 154, 210, 45, 101, 157, 213, 4, 9, 14, 33, 19, 24, 
			31, 44, 100, 156, 212, 50, 106, 162, 218, 53, 56, 59, 62, 65, 
			68, 71, 74, 77, 80, 83, 86, 89, 109, 112, 115, 118, 121, 124, 
			127, 130, 133, 136, 139, 142, 145, 165, 168, 171, 174, 177, 
			180, 183, 186, 189, 192, 195, 198, 201, 221, 224, 227, 230, 
			233, 236, 239, 242, 245, 248, 251, 254, 257, 46, 102, 158, 
			214, 51, 107, 163, 219, 54, 57, 60, 63, 66, 69, 72, 75, 78, 
			81, 84, 87, 90, 110, 113, 116, 119, 122, 125, 128, 131, 134, 
			137, 140, 143, 146, 166, 169, 172, 175, 178, 181, 184, 187, 
			190, 193, 196, 199, 202, 222, 225, 228, 231, 234, 237, 240, 
			243, 246, 249, 252, 255, 258, 5, 10, 15, 28, 32, 34, 35, 16, 
			20, 21, 25, 52, 108, 164, 220, 55, 58, 61, 64, 67, 70, 73, 
			76, 79, 82, 85, 88, 91, 111, 114, 117, 120, 123, 126, 129, 
			132, 135, 138, 141, 144, 147, 167, 170, 173, 176, 179, 182, 
			185, 188, 191, 194, 197, 200, 203, 223, 226, 229, 232, 235, 
			238, 241, 244, 247, 250, 253, 256, 259, 11, 29            
	    };
    }
}